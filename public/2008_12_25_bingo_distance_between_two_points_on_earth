
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Christopher Swenson</title>
	<link href="main.css" rel="stylesheet" type="text/css" />
	<link href="feed" rel="alternate" title="Primary Feed" type="application/atom+xml" />
	<link href="SyntaxHighlighter.css" rel="stylesheet" type="text/css" />

<script src="js/shCore.js" type="text/javascript"></script>
<!--<script src="js/shBrushCSharp.js" type="text/javascript"></script>
<script src="js/shBrushCpp.js" type="text/javascript"></script>
<script src="js/shBrushCss.js" type="text/javascript"></script>
<script src="js/shBrushDelphi.js" type="text/javascript"></script>
<script src="js/shBrushJScript.js" type="text/javascript"></script>
<script src="js/shBrushJava.js" type="text/javascript"></script>
<script src="js/shBrushPhp.js" type="text/javascript"></script>-->
<script src="js/shBrushRuby.js" type="text/javascript"></script>
<script src="js/shBrushPython.js" type="text/javascript"></script>
<!--<script src="js/shBrushSql.js" type="text/javascript"></script>
<script src="js/shBrushVb.js" type="text/javascript"></script>
<script src="js/shBrushXml.js" type="text/javascript"></script>-->

<script language="javascript">
window.onload = function () {
    dp.SyntaxHighlighter.ClipboardSwf = '/flash/clipboard.swf';
    dp.SyntaxHighlighter.HighlightAll('code');
}
</script>

</head>
<body>
<div id="header">
	<div id="logo">
		<img src="images/chrisbluething.png" alt="blue thing" />
		<h1><a href="/">Christopher Swenson</a></h1>
		<p>Computer science, math, programming, and stuff.</p>
	</div>
</div>
<div id="content">
	<div class="postzoom"><h1><a href="2008_12_25_bingo_distance_between_two_points_on_earth">Bingo!  Distance between two points on Earth</a></h1>
<p>As a follow-up to my previous post, I have found two ways of finding the distance between two cities in the US.  One is slow and more correct, one is less slow and less correct.</p>

<p>First, the slow one.  You can take the third formula from the Wikipedia entry for <a href="http://en.wikipedia.org/wiki/Great-circle_distance#Formulas">finding the great-circle distance</a>.  It translates pretty naturally into any language, but involves many trigonometric functions, squares, square roots, etc.  It's quite ugly an inelegant in code, and quite slow.</p>

<p>In Ruby, it looks something like this (the <code>lat</code> and <code>rlat</code> accessors return the latitude in degrees and radians, respectively, and similarly for longitude with <code>lon</code> and <code>rlon</code>).</p>

<pre name="code" class="ruby">  def distance_miles_slow(other)
    3956.54938 * Math.atan2(Math.sqrt((Math.cos(other.rlat) *
        Math.sin(other.rlon - rlon)) ** 2 +
      (Math.cos(rlat) * Math.sin(other.rlat) - Math.sin(rlat) *
        Math.cos(other.rlat) * Math.cos(other.rlon - rlon)) ** 2),
      (Math.sin(rlat) * Math.sin(other.rlat) + Math.cos(rlat) *
        Math.cos(other.rlat) * Math.cos(other.rlon - rlon)))
  end</pre>

<p>Ugh.</p>

<p>It turns out that my na√Øve method of simply using the Pythagorean theorem after finding the "linear" distance in latitude and longitude (from <a href="http://en.wikipedia.org/wiki/Geographic_coordinate_system#Expressing_latitude_and_longitude_as_linear_units">here</a>) is actually pretty good.  Not as accurate, as the rougher figures seem to be off by about 2% at moderate distances (less than 1,000 miles), which is good enough for me at the moment.</p>

<p>Here's what the Ruby for that look like:</p>

<pre name="code" class="ruby">  def distance_miles_fast(other)
    dlat = lat - other.lat
    drlon = rlon - other.rlon
    Math.sqrt((68.9100652 * dlat)**2 +
      (drlon * 3956.54938 * Math.cos(rlat))**2)
  end</pre>

<p>A little bit better, and at least a bit faster.</p>
</div>
	<div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/swenson/embed.js"></script><noscript><a href="http://swenson.disqus.com/?url=http://www.caswenson.com/2008_12_25_bingo_distance_between_two_points_on_earth">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
	<div id="sidebar">
  <h2>Modern Cryptanalysis</h2>
	<div><br />
			<center><a href="http://www.amazon.com/gp/product/047013593X?ie=UTF8&tag=mathfigu-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=047013593X"><img border="0" src="images/21tcdykwdkl_aa_sl160_.jpg"></a><img src="http://www.assoc-amazon.com/e/ir?t=mathfigu-20&l=as2&o=1&a=047013593X" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></center>
	</div>
	<h2>Pages</h2>
		<ul>
	    <li><a href="about">About</a></li>
	    <li><a href="disclosures">Disclousres</a></li>
	    <li><a href="speaking">Speaking</a></li>
		  <li><a href="presentations">Presentations</a></li>
		  <li><a href="mcerrata"><em>Modern Cryptanalaysis</em> Errata</a></li>
		</ul>
	  <h2><a href="past">Archive</a></h2>
	</div>
	<div id="footer">
	<p id="legal">
	Content by Christopher Swenson (<a href="mailto:chris@caswenson.com">chris@caswenson.com</a>) | 
	Design adapted from <a href="http://www.freecsstemplates.org/preview/replenish">Replenish</a>
	</p>
</div>
</body>
</html>